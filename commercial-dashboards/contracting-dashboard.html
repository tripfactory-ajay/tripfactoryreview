<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TripFactory - Contracting Team Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { font-family: 'Inter', sans-serif; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .metric-card {
            transition: all 0.3s;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .urgent { border-left: 4px solid #ef4444; }
        .warning { border-left: 4px solid #f59e0b; }
        .success { border-left: 4px solid #22c55e; }
        .progress-bar {
            transition: width 1s ease-out;
        }
        .contract-row {
            transition: all 0.2s;
        }
        .contract-row:hover {
            background: #f8fafc;
            transform: scale(1.01);
        }
        .negotiation-slider {
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
        }
        .negotiation-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #0066cc;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,102,204,0.4);
        }
        .pulse-alert {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .heatmap-cell {
            transition: all 0.3s;
        }
        .heatmap-cell:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen">

    <!-- Header -->
    <header class="bg-white border-b-2 border-[#0066cc] px-6 py-4 shadow-lg sticky top-0 z-50">
        <div class="max-w-[1920px] mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-gradient-to-br from-[#0066cc] to-[#1e3a5f] rounded-xl flex items-center justify-center text-white text-2xl">
                    <i class="fas fa-file-contract"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-[#1e3a5f]">Contracting Team Dashboard</h1>
                    <p class="text-xs text-slate-500">Contract Performance & Negotiation Intelligence</p>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="flex bg-slate-100 rounded-lg p-1">
                    <button onclick="setPeriod('month')" class="period-btn active px-4 py-2 rounded-md text-sm font-bold bg-[#0066cc] text-white" id="period-month">Month</button>
                    <button onclick="setPeriod('quarter')" class="period-btn px-4 py-2 rounded-md text-sm font-bold text-slate-600" id="period-quarter">Quarter</button>
                    <button onclick="setPeriod('year')" class="period-btn px-4 py-2 rounded-md text-sm font-bold text-slate-600" id="period-year">Year</button>
                </div>
                <button onclick="window.location.href='menu.html'" class="px-4 py-2 bg-slate-200 text-slate-700 rounded-lg text-sm font-bold hover:bg-slate-300 transition">
                    <i class="fas fa-arrow-left mr-2"></i>Back
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-[1920px] mx-auto p-6 space-y-6">

        <!-- KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="metric-card bg-white rounded-xl p-6 shadow-lg border border-slate-200">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <p class="text-sm text-slate-500 mb-1">Active Contracts</p>
                        <h3 class="text-3xl font-bold text-[#1e3a5f]">247</h3>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">
                        <i class="fas fa-handshake text-xl"></i>
                    </div>
                </div>
                <div class="flex items-center gap-2 text-sm">
                    <span class="text-green-500 font-bold"><i class="fas fa-arrow-up"></i> 12</span>
                    <span class="text-slate-400">new this month</span>
                </div>
            </div>

            <div class="metric-card bg-white rounded-xl p-6 shadow-lg border border-slate-200">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <p class="text-sm text-slate-500 mb-1">Contract Value (YTD)</p>
                        <h3 class="text-3xl font-bold text-[#1e3a5f]">$42.8M</h3>
                    </div>
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center text-green-600">
                        <i class="fas fa-dollar-sign text-xl"></i>
                    </div>
                </div>
                <div class="flex items-center gap-2 text-sm">
                    <span class="text-green-500 font-bold"><i class="fas fa-arrow-up"></i> 8.4%</span>
                    <span class="text-slate-400">vs last year</span>
                </div>
            </div>

            <div class="metric-card bg-white rounded-xl p-6 shadow-lg border border-slate-200 urgent">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <p class="text-sm text-slate-500 mb-1">Expiring < 30 Days</p>
                        <h3 class="text-3xl font-bold text-red-600">18</h3>
                    </div>
                    <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center text-red-600 pulse-alert">
                        <i class="fas fa-exclamation-triangle text-xl"></i>
                    </div>
                </div>
                <div class="flex items-center gap-2 text-sm">
                    <span class="text-red-500 font-bold">$3.2M</span>
                    <span class="text-slate-400">at risk</span>
                </div>
            </div>

            <div class="metric-card bg-white rounded-xl p-6 shadow-lg border border-slate-200 warning">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <p class="text-sm text-slate-500 mb-1">Negotiation Opportunities</p>
                        <h3 class="text-3xl font-bold text-orange-600">24</h3>
                    </div>
                    <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center text-orange-600">
                        <i class="fas fa-chart-line text-xl"></i>
                    </div>
                </div>
                <div class="flex items-center gap-2 text-sm">
                    <span class="text-orange-500 font-bold">+$890K</span>
                    <span class="text-slate-400">potential upside</span>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <!-- Left Column: Contract Performance -->
            <div class="lg:col-span-2 space-y-6">
                
                <!-- Best Performing Contracts -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-200 flex justify-between items-center">
                        <h3 class="font-bold text-[#1e3a5f] flex items-center gap-2">
                            <i class="fas fa-trophy text-yellow-500"></i> Best Performing Contracts
                        </h3>
                        <button class="text-sm text-[#0066cc] hover:underline">View All</button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase">Supplier</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase">Destination</th>
                                    <th class="px-4 py-3 text-right text-xs font-bold text-slate-500 uppercase">Revenue</th>
                                    <th class="px-4 py-3 text-right text-xs font-bold text-slate-500 uppercase">Margin</th>
                                    <th class="px-4 py-3 text-center text-xs font-bold text-slate-500 uppercase">Status</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="bestContracts">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Contracts Expiring Soon -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-200 bg-red-50">
                        <h3 class="font-bold text-red-700 flex items-center gap-2">
                            <i class="fas fa-clock"></i> Contracts Expiring Soon (Action Required)
                        </h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase">Supplier</th>
                                    <th class="px-4 py-3 text-left text-xs font-bold text-slate-500 uppercase">Expires</th>
                                    <th class="px-4 py-3 text-right text-xs font-bold text-slate-500 uppercase">Current Value</th>
                                    <th class="px-4 py-3 text-center text-xs font-bold text-slate-500 uppercase">Action</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100" id="expiringContracts">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Enquiry vs Booking Analysis -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-200 p-6">
                    <h3 class="font-bold text-[#1e3a5f] mb-4 flex items-center gap-2">
                        <i class="fas fa-balance-scale text-blue-500"></i> Contract Performance: Enquiries vs Bookings Lost
                    </h3>
                    <div class="h-64">
                        <canvas id="enquiryChart"></canvas>
                    </div>
                    <div class="grid grid-cols-3 gap-4 mt-4">
                        <div class="text-center p-3 bg-blue-50 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600" id="totalEnquiries">1,247</div>
                            <div class="text-xs text-slate-500">Total Enquiries</div>
                        </div>
                        <div class="text-center p-3 bg-red-50 rounded-lg">
                            <div class="text-2xl font-bold text-red-600" id="lostBookings">186</div>
                            <div class="text-xs text-slate-500">Lost to Competition</div>
                        </div>
                        <div class="text-center p-3 bg-green-50 rounded-lg">
                            <div class="text-2xl font-bold text-green-600" id="conversionRate">85.1%</div>
                            <div class="text-xs text-slate-500">Conversion Rate</div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Right Column: Negotiation Tools & Forecaster -->
            <div class="space-y-6">

                <!-- Negotiation Impact Forecaster -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-200 p-6">
                    <h3 class="font-bold text-[#1e3a5f] mb-4 flex items-center gap-2">
                        <i class="fas fa-calculator text-purple-500"></i> Negotiation Impact Forecaster
                    </h3>
                    
                    <div class="mb-4 p-4 bg-purple-50 rounded-lg border border-purple-200">
                        <div class="flex items-center gap-3 mb-2">
                            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600">
                                <i class="fas fa-building"></i>
                            </div>
                            <div>
                                <div class="font-bold text-sm">Marriott International</div>
                                <div class="text-xs text-slate-500">Largest Contract - $8.4M/year</div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-2">
                                Current Commission: <span class="font-bold text-[#0066cc]">12%</span>
                            </label>
                            <input type="range" min="12" max="20" value="12" class="negotiation-slider w-full" id="commissionSlider" oninput="updateForecast()">
                            <div class="flex justify-between text-xs text-slate-400 mt-1">
                                <span>12%</span>
                                <span>16%</span>
                                <span>20%</span>
                            </div>
                        </div>

                        <div class="p-4 bg-slate-50 rounded-lg">
                            <div class="text-sm text-slate-500 mb-1">Projected Annual Revenue Impact</div>
                            <div class="text-3xl font-bold text-green-600" id="revenueImpact">+$0</div>
                            <div class="text-xs text-slate-400 mt-1">Based on forward bookings of 45,000 room nights</div>
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <div class="p-3 bg-green-50 rounded-lg text-center">
                                <div class="text-lg font-bold text-green-600" id="perUnitImpact">+$0</div>
                                <div class="text-xs text-slate-500">Per booking</div>
                            </div>
                            <div class="p-3 bg-blue-50 rounded-lg text-center">
                                <div class="text-lg font-bold text-blue-600" id="monthlyImpact">+$0</div>
                                <div class="text-xs text-slate-500">Monthly</div>
                            </div>
                        </div>

                        <button onclick="saveNegotiationScenario()" class="w-full py-2 bg-purple-600 text-white rounded-lg font-bold hover:bg-purple-700 transition">
                            <i class="fas fa-save mr-2"></i>Save Scenario
                        </button>
                    </div>
                </div>

                <!-- Contracts Needed Based on Enquiries -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-200 p-6">
                    <h3 class="font-bold text-[#1e3a5f] mb-4 flex items-center gap-2">
                        <i class="fas fa-clipboard-list text-orange-500"></i> Contracts Needed
                    </h3>
                    
                    <div class="space-y-3" id="contractsNeeded">
                        <!-- Populated by JS -->
                    </div>

                    <button class="w-full mt-4 py-2 border-2 border-[#0066cc] text-[#0066cc] rounded-lg font-bold hover:bg-blue-50 transition">
                        <i class="fas fa-plus mr-2"></i>Prioritize New Contracts
                    </button>
                </div>

                <!-- Quick Stats -->
                <div class="bg-gradient-to-br from-[#1e3a5f] to-[#0066cc] rounded-xl shadow-lg p-6 text-white">
                    <h3 class="font-bold mb-4">Contract Health Score</h3>
                    <div class="flex items-center justify-center mb-4">
                        <div class="relative w-32 h-32">
                            <svg class="w-full h-full transform -rotate-90">
                                <circle cx="64" cy="64" r="56" stroke="rgba(255,255,255,0.2)" stroke-width="12" fill="none"/>
                                <circle cx="64" cy="64" r="56" stroke="#22c55e" stroke-width="12" fill="none" 
                                    stroke-dasharray="351.86" stroke-dashoffset="52.78" stroke-linecap="round"/>
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <div class="text-3xl font-bold">85%</div>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Rate Competitiveness</span>
                            <span class="font-bold text-green-300">92%</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Inventory Availability</span>
                            <span class="font-bold text-yellow-300">78%</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Commission Structure</span>
                            <span class="font-bold text-green-300">88%</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Bottom Section: Detailed Analysis -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            
            <!-- Contract Performance Heatmap -->
            <div class="bg-white rounded-xl shadow-lg border border-slate-200 p-6">
                <h3 class="font-bold text-[#1e3a5f] mb-4 flex items-center gap-2">
                    <i class="fas fa-th text-indigo-500"></i> Contract Performance Matrix
                </h3>
                <div class="grid grid-cols-5 gap-2" id="performanceMatrix">
                    <!-- Populated by JS -->
                </div>
                <div class="flex justify-between items-center mt-4 text-xs text-slate-500">
                    <span>Low Volume / Low Margin</span>
                    <div class="flex gap-2">
                        <div class="flex items-center gap-1"><div class="w-3 h-3 bg-red-500 rounded"></div> Poor</div>
                        <div class="flex items-center gap-1"><div class="w-3 h-3 bg-yellow-500 rounded"></div> Fair</div>
                        <div class="flex items-center gap-1"><div class="w-3 h-3 bg-green-500 rounded"></div> Good</div>
                        <div class="flex items-center gap-1"><div class="w-3 h-3 bg-blue-500 rounded"></div> Excellent</div>
                    </div>
                    <span>High Volume / High Margin</span>
                </div>
            </div>

            <!-- Revenue Impact Simulator -->
            <div class="bg-white rounded-xl shadow-lg border border-slate-200 p-6">
                <h3 class="font-bold text-[#1e3a5f] mb-4 flex items-center gap-2">
                    <i class="fas fa-chart-line text-green-500"></i> Revenue Impact Simulator
                </h3>
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                        <div>
                            <div class="font-bold text-sm">Scenario: +2% Commission</div>
                            <div class="text-xs text-slate-500">All hotel contracts</div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-green-600">+$1.24M</div>
                            <div class="text-xs text-slate-400">Annual impact</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                        <div>
                            <div class="font-bold text-sm">Scenario: Rate Parity Improvement</div>
                            <div class="text-xs text-slate-500">Top 10 suppliers</div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-green-600">+$890K</div>
                            <div class="text-xs text-slate-400">Annual impact</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                        <div>
                            <div class="font-bold text-sm">Scenario: Exclusive Rates</div>
                            <div class="text-xs text-slate-500">Maldives & Thailand</div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-green-600">+$2.1M</div>
                            <div class="text-xs text-slate-400">Annual impact</div>
                        </div>
                    </div>
                </div>
                <button class="w-full mt-4 py-2 bg-[#0066cc] text-white rounded-lg font-bold hover:bg-[#0052a3] transition">
                    <i class="fas fa-play mr-2"></i>Run Full Simulation
                </button>
            </div>

        </div>

    </main>

    <script>
        // Contract Data
        const contracts = [
            { supplier: 'Marriott International', destination: 'Multiple', revenue: 8400000, margin: 18.5, status: 'excellent', expiry: '2025-12-31' },
            { supplier: 'Hilton Worldwide', destination: 'USA/Europe', revenue: 6200000, margin: 16.2, status: 'good', expiry: '2025-08-15' },
            { supplier: 'Accor Hotels', destination: 'Europe/Asia', revenue: 4800000, margin: 15.8, status: 'good', expiry: '2025-06-30' },
            { supplier: 'InterContinental', destination: 'Global', revenue: 3900000, margin: 14.2, status: 'fair', expiry: '2025-04-15' },
            { supplier: 'Hyatt Hotels', destination: 'USA/Asia', revenue: 2800000, margin: 17.1, status: 'good', expiry: '2025-09-20' },
            { supplier: 'Four Seasons', destination: 'Luxury Global', revenue: 2100000, margin: 22.4, status: 'excellent', expiry: '2025-11-30' },
            { supplier: 'Shangri-La', destination: 'Asia Pacific', revenue: 1800000, margin: 19.3, status: 'good', expiry: '2025-05-15' },
            { supplier: 'Atlantis Dubai', destination: 'Dubai', revenue: 1650000, margin: 12.8, status: 'fair', expiry: '2025-03-30' }
        ];

        const expiringSoon = [
            { supplier: 'Atlantis Dubai', daysLeft: 45, value: 1650000, action: 'Renegotiate rates' },
            { supplier: 'Jumeirah Hotels', daysLeft: 28, value: 980000, action: 'Extend contract' },
            { supplier: 'Sandals Resorts', daysLeft: 32, value: 1200000, action: 'Review terms' },
            { supplier: 'Club Med', daysLeft: 18, value: 890000, action: 'Urgent renewal' },
            { supplier: 'Airbnb Luxe', daysLeft: 52, value: 650000, action: 'Evaluate performance' }
        ];

        const contractsNeeded = [
            { destination: 'Bali Luxury Villas', enquiries: 245, conversion: 12, priority: 'High' },
            { destination: 'Maldives Overwater', enquiries: 189, conversion: 8, priority: 'High' },
            { destination: 'Thailand Boutique', enquiries: 312, conversion: 15, priority: 'Medium' },
            { destination: 'Greek Islands', enquiries: 156, conversion: 18, priority: 'Medium' },
            { destination: 'Caribbean All-Inclusive', enquiries: 423, conversion: 22, priority: 'Critical' }
        ];

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            renderBestContracts();
            renderExpiringContracts();
            renderContractsNeeded();
            renderPerformanceMatrix();
            initCharts();
            updateForecast();
        });

        function renderBestContracts() {
            const tbody = document.getElementById('bestContracts');
            const sorted = [...contracts].sort((a, b) => b.revenue - a.revenue).slice(0, 5);
            
            tbody.innerHTML = sorted.map(c => `
                <tr class="contract-row">
                    <td class="px-4 py-3">
                        <div class="font-bold text-sm text-[#1e3a5f]">${c.supplier}</div>
                    </td>
                    <td class="px-4 py-3 text-sm text-slate-600">${c.destination}</td>
                    <td class="px-4 py-3 text-right font-bold text-sm">$${(c.revenue/1000000).toFixed(2)}M</td>
                    <td class="px-4 py-3 text-right font-bold text-sm text-green-600">${c.margin}%</td>
                    <td class="px-4 py-3 text-center">
                        <span class="px-2 py-1 rounded-full text-xs font-bold ${getStatusColor(c.status)}">
                            ${c.status.charAt(0).toUpperCase() + c.status.slice(1)}
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        function renderExpiringContracts() {
            const tbody = document.getElementById('expiringContracts');
            
            tbody.innerHTML = expiringSoon.map(e => `
                <tr class="contract-row ${e.daysLeft < 30 ? 'bg-red-50' : ''}">
                    <td class="px-4 py-3 font-bold text-sm text-[#1e3a5f]">${e.supplier}</td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-1 rounded text-xs font-bold ${e.daysLeft < 30 ? 'bg-red-200 text-red-700' : 'bg-yellow-200 text-yellow-700'}">
                            ${e.daysLeft} days
                        </span>
                    </td>
                    <td class="px-4 py-3 text-right font-bold text-sm">$${(e.value/1000000).toFixed(2)}M</td>
                    <td class="px-4 py-3 text-center">
                        <button class="px-3 py-1 bg-[#0066cc] text-white rounded text-xs font-bold hover:bg-[#0052a3]">
                            ${e.action}
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function renderContractsNeeded() {
            const container = document.getElementById('contractsNeeded');
            
            container.innerHTML = contractsNeeded.map(c => `
                <div class="flex items-center justify-between p-3 bg-slate-50 rounded-lg border-l-4 ${c.priority === 'Critical' ? 'border-red-500' : c.priority === 'High' ? 'border-orange-500' : 'border-yellow-500'}">
                    <div>
                        <div class="font-bold text-sm text-[#1e3a5f]">${c.destination}</div>
                        <div class="text-xs text-slate-500">${c.enquiries} enquiries, ${c.conversion}% converted</div>
                    </div>
                    <div class="text-right">
                        <span class="px-2 py-1 rounded text-xs font-bold ${c.priority === 'Critical' ? 'bg-red-100 text-red-700' : c.priority === 'High' ? 'bg-orange-100 text-orange-700' : 'bg-yellow-100 text-yellow-700'}">
                            ${c.priority}
                        </span>
                    </div>
                </div>
            `).join('');
        }

        function renderPerformanceMatrix() {
            const matrix = document.getElementById('performanceMatrix');
            const hotels = ['Marriott', 'Hilton', 'Accor', 'IHG', 'Hyatt', 'Four Seasons', 'Shangri-La', 'Atlantis', 'Sandals', 'Club Med'];
            
            matrix.innerHTML = hotels.map(h => {
                const performance = Math.random();
                let color = 'bg-red-500';
                if (performance > 0.75) color = 'bg-blue-500';
                else if (performance > 0.5) color = 'bg-green-500';
                else if (performance > 0.25) color = 'bg-yellow-500';
                
                return `
                    <div class="heatmap-cell ${color} rounded-lg p-3 text-center text-white cursor-pointer" title="${h}: ${(performance*100).toFixed(0)}% performance">
                        <div class="text-xs font-bold truncate">${h}</div>
                        <div class="text-lg font-bold">${(performance*100).toFixed(0)}%</div>
                    </div>
                `;
            }).join('');
        }

        function getStatusColor(status) {
            const colors = {
                excellent: 'bg-blue-100 text-blue-700',
                good: 'bg-green-100 text-green-700',
                fair: 'bg-yellow-100 text-yellow-700',
                poor: 'bg-red-100 text-red-700'
            };
            return colors[status] || 'bg-slate-100 text-slate-700';
        }

        function updateForecast() {
            const slider = document.getElementById('commissionSlider');
            const currentCommission = 12;
            const newCommission = parseInt(slider.value);
            const increase = newCommission - currentCommission;
            
            const forwardBookings = 45000; // room nights
            const avgRate = 280; // average room rate
            
            const additionalRevenue = (forwardBookings * avgRate * (increase / 100));
            const annualImpact = additionalRevenue;
            const monthlyImpact = annualImpact / 12;
            const perBooking = additionalRevenue / forwardBookings;
            
            document.getElementById('revenueImpact').textContent = '+$' + (annualImpact / 1000000).toFixed(2) + 'M';
            document.getElementById('monthlyImpact').textContent = '+$' + (monthlyImpact / 1000).toFixed(0) + 'K';
            document.getElementById('perUnitImpact').textContent = '+$' + perBooking.toFixed(2);
        }

        function saveNegotiationScenario() {
            const slider = document.getElementById('commissionSlider');
            alert(`Scenario saved: ${slider.value}% commission rate\nProjected additional revenue: ${document.getElementById('revenueImpact').textContent}`);
        }

        function initCharts() {
            // Enquiry vs Booking Chart
            const ctx = document.getElementById('enquiryChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Marriott', 'Hilton', 'Accor', 'IHG', 'Hyatt', 'Independent'],
                    datasets: [{
                        label: 'Enquiries',
                        data: [450, 380, 320, 290, 240, 520],
                        backgroundColor: 'rgba(0, 102, 204, 0.8)'
                    }, {
                        label: 'Lost to Competition',
                        data: [45, 52, 68, 85, 38, 180],
                        backgroundColor: 'rgba(239, 68, 68, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        function setPeriod(period) {
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-[#0066cc]', 'text-white');
                btn.classList.add('text-slate-600');
            });
            document.getElementById('period-' + period).classList.add('active', 'bg-[#0066cc]', 'text-white');
            document.getElementById('period-' + period).classList.remove('text-slate-600');
            
            // Refresh data based on period
            alert(`Switched to ${period} view - data refreshed`);
        }
    </script>
</body>
</html>